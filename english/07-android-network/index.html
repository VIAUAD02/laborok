
<!doctype html>
<html lang="hu" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Tóth Tibor, Gincsai Gábor, Ekler Péter, Gazdi László, Pomázi Krisztián, Kövesdán Gábor">
      
      
      
      
      <link rel="icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.4">
    
    
      
        <title>Labor 07 - Retrofit - Weather app - BMEVIAUAD02 - Mobil- és webes szoftverek laborfeladatok</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.9c788c91.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/timeago.css">
    
      <link rel="stylesheet" href="../../extra-material-theme.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="aut" data-md-color-primary="red" data-md-color-accent="red">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#labor-07-retrofit-weather-app" class="md-skip">
          Kihagyás
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Élőfej">
    <a href="../.." title="BMEVIAUAD02 - Mobil- és webes szoftverek laborfeladatok" class="md-header__button md-logo" aria-label="BMEVIAUAD02 - Mobil- és webes szoftverek laborfeladatok" data-md-component="logo">
      
  <img src="../../logo-bme-aut.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BMEVIAUAD02 - Mobil- és webes szoftverek laborfeladatok
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Labor 07 - Retrofit - Weather app
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="aut" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Váltás sötét témára"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Váltás sötét témára" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent=""  aria-label="Váltás világos témára"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Váltás világos témára" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Keresés" placeholder="Keresés" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Törlés" aria-label="Törlés" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Keresés inicializálása
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/viauad02/laborok" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    viauad02/laborok
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Lapok" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        Tudnivalók
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../laborok/01-android-hello-world/" class="md-tabs__link">
        Mobil Laborok
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../laborok/08-http/" class="md-tabs__link">
        Webes Laborok
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigáció" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BMEVIAUAD02 - Mobil- és webes szoftverek laborfeladatok" class="md-nav__button md-logo" aria-label="BMEVIAUAD02 - Mobil- és webes szoftverek laborfeladatok" data-md-component="logo">
      
  <img src="../../logo-bme-aut.png" alt="logo">

    </a>
    BMEVIAUAD02 - Mobil- és webes szoftverek laborfeladatok
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/viauad02/laborok" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    viauad02/laborok
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" tabindex="0" aria-expanded="false">
          Tudnivalók
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tudnivalók" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Tudnivalók
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Tárgy ismertető
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tudnivalok/github/GitHub/" class="md-nav__link">
        Feladatok beadása (GitHub)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tudnivalok/github/GitHub-Actions/" class="md-nav__link">
        GitHub Actions ismertető
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tudnivalok/github/GitHub-credentials/" class="md-nav__link">
        Egyetemi laborokban: GitHub belépés
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tudnivalok/github/contributing/" class="md-nav__link">
        Hozzájárulás az anyaghoz
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" tabindex="0" aria-expanded="false">
          Mobil Laborok
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Mobil Laborok" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Mobil Laborok
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../laborok/01-android-hello-world/" class="md-nav__link">
        Labor 01 - Hello World
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../laborok/02-android-ui/" class="md-nav__link">
        Labor 02 - UI - Tömegközlekedési alkalmazás
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../laborok/03-android-ui-adv/" class="md-nav__link">
        Labor 03 - UI, LazyColumn - Kiadás és bevétel kezelő alkalmazás
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../laborok/04-android-ui-charts/" class="md-nav__link">
        Labor 04 - UI,HorizontalPager, Charts - HR alkalmazás
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../laborok/05-android-sqlite/" class="md-nav__link">
        Labor 05 - SQLite - Rajzoló alkalmazás
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../laborok/06-android-room/" class="md-nav__link">
        Labor 06 - Room - Bevásárló lista alkalmazás
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../laborok/07-android-network/" class="md-nav__link">
        Labor 07 - Retrofit - Időjárás alkalmazás
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" tabindex="0" aria-expanded="false">
          Webes Laborok
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Webes Laborok" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Webes Laborok
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../laborok/08-http/" class="md-nav__link">
        Labor 08 - HTTP, HTML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../laborok/09-css/" class="md-nav__link">
        Labor 09 - CSS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../laborok/10-bootstrap/" class="md-nav__link">
        Labor 10 - Bootstrap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../laborok/11-js/" class="md-nav__link">
        Labor 11 - JavaScript alapok
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../laborok/12-js-advanced/" class="md-nav__link">
        Labor 12 - Haladó JavaScript
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../laborok/13-jquery/" class="md-nav__link">
        Labor 13 - jQuery
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tartalomjegyzék">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#application-specification" class="md-nav__link">
    Application Specification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-tasks" class="md-nav__link">
    Lab tasks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparations" class="md-nav__link">
    Preparations
  </a>
  
    <nav class="md-nav" aria-label="Preparations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-and-downloading-a-git-repository" class="md-nav__link">
    Creating and downloading a Git repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-project" class="md-nav__link">
    Creating a project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-dependencies" class="md-nav__link">
    Adding dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-permissions" class="md-nav__link">
    Add permissions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-resources" class="md-nav__link">
    Adding Resources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openweathermap-api-key" class="md-nav__link">
    OpenWeatherMap API key
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-a-city-list-1-point" class="md-nav__link">
    Implementing a city list (1 point)
  </a>
  
    <nav class="md-nav" aria-label="Implementing a city list (1 point)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#architecture-design" class="md-nav__link">
    Architecture design
  </a>
  
    <nav class="md-nav" aria-label="Architecture design">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-model-class" class="md-nav__link">
    The model class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-repository" class="md-nav__link">
    The repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-viewmodel" class="md-nav__link">
    The ViewModel
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing-the-city-list-screen" class="md-nav__link">
    Implementing the city list screen
  </a>
  
    <nav class="md-nav" aria-label="Implementing the city list screen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-components" class="md-nav__link">
    Creating the components
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-the-citylistscreen" class="md-nav__link">
    Building the CityListScreen
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-the-navigation" class="md-nav__link">
    Creating the navigation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-the-weather-view-and-connecting-it-to-the-navigation-2-points" class="md-nav__link">
    Creating the weather view and connecting it to the navigation (2 points)
  </a>
  
    <nav class="md-nav" aria-label="Creating the weather view and connecting it to the navigation (2 points)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#designing-the-architecture" class="md-nav__link">
    Designing the architecture
  </a>
  
    <nav class="md-nav" aria-label="Designing the architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-classes" class="md-nav__link">
    Model Classes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repository" class="md-nav__link">
    Repository
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-viewmodel_1" class="md-nav__link">
    The ViewModel
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-weather-interface" class="md-nav__link">
    The weather interface
  </a>
  
    <nav class="md-nav" aria-label="The weather interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#components" class="md-nav__link">
    Components
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-the-weatherscreen" class="md-nav__link">
    Creating the WeatherScreen
  </a>
  
    <nav class="md-nav" aria-label="Creating the WeatherScreen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#connection-to-navigation" class="md-nav__link">
    Connection to navigation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-the-network-communication-1-point" class="md-nav__link">
    Creating the Network Communication (1 point)
  </a>
  
    <nav class="md-nav" aria-label="Creating the Network Communication (1 point)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementing-the-weatherapi" class="md-nav__link">
    Implementing the WeatherAPI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updating-the-retrofitweatherrepository" class="md-nav__link">
    Updating the RetrofitWeatherRepository
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#independent-task-implementing-deletion-from-city-list-1-point" class="md-nav__link">
    Independent task: implementing deletion from city list (1 point)
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  



<h1 id="labor-07-retrofit-weather-app">Labor 07 - Retrofit - Weather app<a class="headerlink" href="#labor-07-retrofit-weather-app" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>The task of this lab is to create an application that displays weather information. In addition to using the UI elements we saw earlier, we will also see an example of an efficient implementation of network communication using the <a href="https://square.github.io/retrofit/"><code>Retrofit</code></a> library.</p>
<p>The application displays a list of cities in a <a href="https://developer.android.com/develop/ui/compose/lists"><code>LazyColumn</code></a> and queries the weather data of the selected city using the <em>REST API</em> of <a href="https://openweathermap.org/">OpenWeatherMap</a>. A new city can be added by pressing a <a href="https://developer.android.com/guide/topics/ui/floating-action-button"><code>FloatingActionButton</code></a>.</p>
<div class="admonition info">
<p class="admonition-title">REST</p>
<p>REST = <a href="https://en.wikipedia.org/wiki/Representational_state_transfer">Representational State Transfer</a></p>
</div>
<p>Technologies used:</p>
<ul>
<li><a href="https://developer.android.com/guide/components/activities/intro-activities"><code>Activity</code></a></li>
<li><a href="https://developer.android.com/develop/ui/compose/lists"><code>LazyColumn</code></a></li>
<li><a href="https://square.github.io/retrofit/"><code>Retrofit</code></a></li>
<li><a href="https://github.com/square/moshi"><code>Moshi</code></a></li>
<li><a href="https://github.com/coil-kt/coil"><code>Coil</code></a></li>
<li><a href="https://developer.android.com/topic/libraries/architecture/viewmodel"><code>ViewModel</code></a></li>
<li><a href="https://developer.android.com/develop/ui/compose/navigation"><code>NavHost</code></a></li>
<li><a href="https://developer.android.com/reference/kotlin/androidx/compose/material3/package-summary#SwipeToDismissBox(androidx.compose.material3.SwipeToDismissBoxState,kotlin.Function1,androidx.compose.ui.Modifier,kotlin.Boolean,kotlin.Boolean,kotlin.Boolean,kotlin.Function1)"><code>SwipeToDismissBox</code></a></li>
</ul>
<h2 id="application-specification">Application Specification<a class="headerlink" href="#application-specification" title="Permanent link">&para;</a></h2>
<p>The application consists of an <code>Activity</code>.</p>
<p>The <code>CityListScreen</code> that appears when the application starts displays a list of cities added by the user. Dragging the cities to the left deletes the given city from the list. A new city can be added by pressing the <code>FloatingActionButton</code> in the lower right corner of the view.</p>
<p>Clicking on a city brings up a new <em>Composable</em> screen with the weather data of the given city using <code>NavGraph</code>. In addition to the short description, an actual icon and the average, minimum and maximum temperature, air pressure and humidity values ​​measured in the city are displayed.</p>
<p align="center">
<img src="./assets/list.png" width="240">
<img src="./assets/dialog.png" width="240">
<img src="./assets/weather.png" width="240">
</p>

<h2 id="lab-tasks">Lab tasks<a class="headerlink" href="#lab-tasks" title="Permanent link">&para;</a></h2>
<p>During the lab, the following tasks must be completed with the help of the lab leader, and the designated tasks must be completed independently.</p>
<ol>
<li>Implementing a city list: 1 point</li>
<li>Creating a weather view and connecting it to the navigation: 2 points</li>
<li>Implementing network communication: 1 point</li>
<li>Independent task: implementing deleting a city from the list: 1 point</li>
</ol>
<p>During the lab, a complex weather application will be created. Due to the limited time frame of the lab, it will be necessary to copy larger code blocks, but in any case, pay attention to the lab leader's explanation so that the code sections are understandable. The goal is to understand the presented codes and learn how to use the libraries used.</p>
<p><em>We apologize for the larger code blocks than before, but such a demonstration-type task cannot be solved in a smaller size, and the lab would lose its essence if we only implemented a "hello world" network communication request. Thank you for your understanding.</em></p>
<h2 id="preparations">Preparations<a class="headerlink" href="#preparations" title="Permanent link">&para;</a></h2>
<p>When solving the tasks, do not forget to follow the <a href="../ithub/GitHub.md">task submission process</a>.</p>
<h3 id="creating-and-downloading-a-git-repository">Creating and downloading a Git repository<a class="headerlink" href="#creating-and-downloading-a-git-repository" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>Find the lab invitation URL in Moodle and use it to create your own repository.</p>
</li>
<li>
<p>Wait until the repository is ready, then checkout it.</p>
<div class="admonition tip">
<p>In university labs, if the system does not ask for a username and password during checkout and the checkout fails, the system probably tried to use a username previously saved on the computer. First, delete the saved login data and try again.</p>
</div>
</li>
<li>
<p>Create a new branch called <code>solution</code> and work on this branch.</p>
</li>
<li>
<p>Write your Neptun code in the <code>neptun.txt</code> file. Nothing else should be in the file, except the 6 characters of the Neptun code on a single line.</p>
</li>
</ol>
<h3 id="creating-a-project">Creating a project<a class="headerlink" href="#creating-a-project" title="Permanent link">&para;</a></h3>
<p>First, launch Android Studio, then:
1. Create a new project, select <em>Empty Activity</em>.
2. Name the project <code>WeatherInfo</code>, and the starting package <code>hu.bme.aut.android.weatherinfo</code>
3. Select <em>Kotlin</em> as the language.
4. The minimum API level should be <strong>API24: Android 7.0.</strong>
5. The <em>Build configuration language</em> should be Kotlin DSL.</p>
<div class="admonition danger">
<p class="admonition-title">FILE PATH</p>
<p>The project should be placed in the WeatherInfo directory in the repository, and it should be pushed when submitted! Without the code, we cannot give maximum points to the lab!</p>
</div>
<h3 id="adding-dependencies">Adding dependencies<a class="headerlink" href="#adding-dependencies" title="Permanent link">&para;</a></h3>
<p>Let's add the required libraries to the <code>libs.versions.toml</code> file:
<div class="highlight"><pre><span></span><code><span class="k">[versions]</span>
<span class="n">coilCompose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;2.6.0&quot;</span>
<span class="n">moshi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1.15.1&quot;</span>
<span class="n">retrofit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;2.11.0&quot;</span>
<span class="n">navigationCompose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;2.8.2&quot;</span>

<span class="k">[libraries]</span>
<span class="n">androidx-navigation-compose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;androidx.navigation&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="s">&quot;navigation-compose&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;navigationCompose&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">coil-compose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;io.coil-kt&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="s">&quot;coil-compose&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;coilCompose&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">squareup-moshi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;com.squareup.moshi&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;moshi-kotlin&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;moshi&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">converter-moshi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;com.squareup.retrofit2&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;converter-moshi&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;retrofit&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">retrofit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;com.squareup.retrofit2&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;retrofit&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;retrofit&quot;</span><span class="w"> </span><span class="p">}</span>
</code></pre></div></p>
<p>Then, in the <code>build.gradle</code> file for the <em>app</em> module, add the following to the <code>dependencies</code> block:</p>
<div class="highlight"><pre><span></span><code><span class="n">dependencies</span><span class="p">{</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">androidx</span><span class="p">.</span><span class="na">navigation</span><span class="p">.</span><span class="na">compose</span><span class="p">)</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">retrofit</span><span class="p">)</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">squareup</span><span class="p">.</span><span class="na">moshi</span><span class="p">)</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">converter</span><span class="p">.</span><span class="na">moshi</span><span class="p">)</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="n">libs</span><span class="p">.</span><span class="na">coil</span><span class="p">.</span><span class="na">compose</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Then click the <strong>Sync now</strong> button in the upper right corner.</p>
<div class="admonition info">
<p class="admonition-title">Retrofit</p>
<p><code>Retrofit</code> generates an implementation of HTTP calls based on simple, properly annotated interfaces described by the developer. It handles parameters given inline in the URL, URL queries, etc. It also supports the most popular serialization/deserialization solutions (e.g.: <a href="https://github.com/google/gson"><code>Gson</code></a>, <a href="https://github.com/square/moshi"><code>Moshi</code></a>, <a href="https://sourceforge.net/projects/simple/"><code>Simple XML</code></a>, etc.), which can be used to implement bidirectional conversion between Java/Kotlin objects and JSON or XML format data. In the lab, we will use <code>Moshi</code> to convert weather data received in JSON.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Coil</p>
<p><code>Coil</code> is an efficient image loading and caching library for Android. We use it because of its simple <em>interface</em> and efficiency.</p>
</div>
<h3 id="add-permissions">Add permissions<a class="headerlink" href="#add-permissions" title="Permanent link">&para;</a></h3>
<p>The application will need internet access. In the <code>AndroidManifest.xml</code> file, add the <em>Internet permission</em> outside the <code>application</code> tag:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.INTERNET&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Permissions</p>
<p>Since API 23 (6.0, Marshmallow) on Android, permissions have been divided into two groups. For permissions in the <em>normal</em> group, it is enough to add them to the <code>AndroidManifest.xml</code> file as seen above and the application will automatically receive them. In the case of permissions in the <em>dangerous</em> group, this is no longer enough; they must be explicitly requested from the user at runtime, who can deny the application the requested permission at any time. You can learn more about managing permissions at <a href="https://developer.android.com/guide/topics/permissions/overview">developer.android.com</a>.</p>
</div>
<h3 id="adding-resources">Adding Resources<a class="headerlink" href="#adding-resources" title="Permanent link">&para;</a></h3>
<p>Download the <a href="downloads/res.zip">zipped file</a> containing the images used in the application, and then place its contents in the <em>res</em> folder of our project.</p>
<p>Add the following text resources to <code>res/values/strings.xml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;resources&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;app_name&quot;</span><span class="nt">&gt;</span>WeatherInfo<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;new_city&quot;</span><span class="nt">&gt;</span>New<span class="w"> </span>city<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;ok&quot;</span><span class="nt">&gt;</span>OK<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cancel&quot;</span><span class="nt">&gt;</span>Cancel<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;weather_in&quot;</span><span class="nt">&gt;</span>Weather<span class="w"> </span>in<span class="w"> </span>%1$s<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;some_error_message&quot;</span><span class="nt">&gt;</span>Something<span class="w"> </span>went<span class="w"> </span>wrong.<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;label_temperature&quot;</span><span class="nt">&gt;</span>Temperature<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;label_min_temperature&quot;</span><span class="nt">&gt;</span>Min.<span class="w"> </span>temperature<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;label_max_temperature&quot;</span><span class="nt">&gt;</span>Max.<span class="w"> </span>temperature<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;label_pressure&quot;</span><span class="nt">&gt;</span>Pressure<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;label_humidity&quot;</span><span class="nt">&gt;</span>Humidity<span class="nt">&lt;/string&gt;</span>
<span class="w">    </span><span class="nt">&lt;string</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;new_city_hint&quot;</span><span class="nt">&gt;</span>City<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;/resources&gt;</span>
</code></pre></div>
<h3 id="openweathermap-api-key">OpenWeatherMap API key<a class="headerlink" href="#openweathermap-api-key" title="Permanent link">&para;</a></h3>
<p>Let's register our own user on the <a href="https://openweathermap.org/">OpenWeatherMap</a> page and create an API key, which we will use to use the service in our application!</p>
<ol>
<li>Click on <em>Sign in</em> and then on the <em>Create an account</em> button.</li>
<li>Fill out the registration form</li>
<li>The value of the <em>Company</em> field should be "BME", the value of the <em>Purpose</em> should be "Education/Science"</li>
<li>After successful registration, the API key created by default can be found on the <em>API keys</em> tab.</li>
</ol>
<p>We will need the received API key later for the API call to retrieve weather data.</p>
<h2 id="implementing-a-city-list-1-point">Implementing a city list (1 point)<a class="headerlink" href="#implementing-a-city-list-1-point" title="Permanent link">&para;</a></h2>
<p>Let's implement the <code>CityListScreen</code> consisting of a <code>LazyColumn</code>, which displays a list of cities!</p>
<p>By clicking on the city name, the weather view (<em>WeatherScreen</em>) will appear, where the weather information will be downloaded. A <em>FloatingActionButton</em> will be used to add a new city.</p>
<h3 id="architecture-design">Architecture design<a class="headerlink" href="#architecture-design" title="Permanent link">&para;</a></h3>
<p>The data source will be a <em>repository</em>, similar to what we saw in the previous lab. From here we will get our cities (currently only stored in memory).</p>
<h4 id="the-model-class">The model class<a class="headerlink" href="#the-model-class" title="Permanent link">&para;</a></h4>
<p>Let's add a <code>data</code> to our main <em>package</em>, then a <code>local</code> within it, and then a <code>model</code> <em>package</em> within it. The class representing our cities will be placed here, which in this case only has an <em>id</em> and a <em>name</em>.</p>
<p><code>City.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.local.model</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">City</span><span class="p">(</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">id</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">name</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="p">)</span>
</code></pre></div>
<h4 id="the-repository">The repository<a class="headerlink" href="#the-repository" title="Permanent link">&para;</a></h4>
<p>After this, we can create our <em>repositories</em> as we have seen in the <code>hu.bme.aut.android.weatherinfo.data.local.repository</code> <em>package</em>.</p>
<p><code>ICityRepository.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.local.repository</span>

<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.local.model.City</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.Flow</span>

<span class="kd">interface</span><span class="w"> </span><span class="nc">ICityRepository</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getAllCities</span><span class="p">():</span><span class="w"> </span><span class="n">Flow</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">City</span><span class="o">&gt;&gt;</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">addCityByName</span><span class="p">(</span><span class="n">cityName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p><code>MemoryCityRepository.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.local.repository</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.mutableStateListOf</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.local.model.City</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.Flow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.flow</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">MemoryCityRepository</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ICityRepository</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">nextId</span><span class="o">=</span><span class="m">3</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">cities</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mutableStateListOf</span><span class="p">(</span>
<span class="w">        </span><span class="n">City</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Budapest&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="n">City</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;London&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="n">City</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Berlin&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getAllCities</span><span class="p">():</span><span class="w"> </span><span class="n">Flow</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">City</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">emit</span><span class="p">(</span><span class="n">cities</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">addCityByName</span><span class="p">(</span><span class="n">cityName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">cities</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">City</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nextId</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cityName</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<p>After creating the <em>repository</em>, let's instantiate it in our <em>application</em> class in the <code>hu.bme.aut.android.weatherinfo</code> <em>package</em>.</p>
<p><code>WeatherInfo.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo</span>

<span class="k">import</span><span class="w"> </span><span class="nn">android.app.Application</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.local.repository.ICityRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.local.repository.MemoryCityRepository</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">WeatherInfoApplication</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Application</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">companion</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="err">{</span>

<span class="w">        </span><span class="kd">lateinit</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">cityRepository</span><span class="p">:</span><span class="w"> </span><span class="n">ICityRepository</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">()</span>

<span class="w">        </span><span class="n">cityRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MemoryCityRepository</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Then, in <code>AndroidManifest.xml</code>, we configure the use of our <em>application</em> class.</p>
<p><code>AndroidManifest.xml</code>:</p>
<div class="highlight"><pre><span></span><code>...
<span class="nt">&lt;application</span>
<span class="w">        </span><span class="na">android:name=</span><span class="s">&quot;.WeatherInfoApplication&quot;</span>
<span class="err">...</span>
</code></pre></div>
<h4 id="the-viewmodel">The ViewModel<a class="headerlink" href="#the-viewmodel" title="Permanent link">&para;</a></h4>
<p>Once we have the <em>repository</em>, we can continue with the next layer, the <em>viewmodel</em>. We will create the <em>viewmodel</em> and <em>screen</em> for the city list in the <code>hu.bme.aut.android.weatherinfo.feature.citylist</code> <em>package</em>. So let's create a new <em>package</em> for the state called <code>state</code>, and then place <code>CityListState</code> in it.</p>
<p><code>CityListState.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.citylist.state</span>

<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.local.model.City</span>


<span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">CityListState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Loading</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">CityListState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Error</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">error</span><span class="p">:</span><span class="w"> </span><span class="n">Throwable</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">CityListState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Result</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">cityList</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">City</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">CityListState</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>
<p>After this, the <em>viewmodel</em> can be added to the <code>citylist</code> <em>package</em>:</p>
<p><code>CityListViewModel.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.citylist</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.ViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.ViewModelProvider</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.viewModelScope</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.viewmodel.initializer</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.viewmodel.viewModelFactory</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.WeatherInfoApplication</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.local.model.City</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.local.repository.ICityRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.citylist.state.CityListState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.MutableStateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.asStateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.collectLatest</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.launch</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">CityListViewModel</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">cityRepository</span><span class="p">:</span><span class="w"> </span><span class="n">ICityRepository</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ViewModel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="o">&lt;</span><span class="n">CityListState</span><span class="o">&gt;</span><span class="p">(</span><span class="n">CityListState</span><span class="p">.</span><span class="na">Loading</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="k">init</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">getAllCities</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getAllCities</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CityListState</span><span class="p">.</span><span class="na">Loading</span>
<span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">cityRepository</span><span class="p">.</span><span class="na">getAllCities</span><span class="p">().</span><span class="na">collectLatest</span><span class="p">{</span>
<span class="w">                    </span><span class="n">_state</span><span class="p">.</span><span class="na">tryEmit</span><span class="p">(</span><span class="n">CityListState</span><span class="p">.</span><span class="na">Result</span><span class="p">(</span><span class="nb">it</span><span class="p">))</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CityListState</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">addCity</span><span class="p">(</span><span class="n">city</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">cityRepository</span><span class="p">.</span><span class="na">addCityByName</span><span class="p">(</span><span class="n">city</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">()</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">companion</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">Factory</span><span class="p">:</span><span class="w"> </span><span class="n">ViewModelProvider</span><span class="p">.</span><span class="na">Factory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewModelFactory</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">initializer</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">CityListViewModel</span><span class="p">(</span>
<span class="w">                    </span><span class="n">cityRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WeatherInfoApplication</span><span class="p">.</span><span class="na">cityRepository</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="implementing-the-city-list-screen">Implementing the city list screen<a class="headerlink" href="#implementing-the-city-list-screen" title="Permanent link">&para;</a></h3>
<p>Now our city data is ready to be displayed on the interface. Before creating the <code>CityListScreen</code>, however, let's first create the components that make it up.</p>
<h4 id="creating-the-components">Creating the components<a class="headerlink" href="#creating-the-components" title="Permanent link">&para;</a></h4>
<p>We will display our cities on a <em>card</em>, which has an icon, which for now is just a <em>placeholder</em>, a caption, and a <code>SwipeToDismissBox</code> that will make it disappear if you swipe it to the left. Let's create this component in the <code>hu.bme.aut.android.weatherinfo.feature.citylist.components</code> <em>package</em>.</p>
<p><code>CityCard.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.citylist.components</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.background</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.clickable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.Arrangement</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.Row</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.fillMaxSize</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.fillMaxWidth</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.padding</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.size</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.shape.RoundedCornerShape</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.Icons</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.filled.Delete</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.ExperimentalMaterial3Api</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.Icon</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.ListItem</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.ListItemDefaults</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.MaterialTheme</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.OutlinedCard</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.SwipeToDismissBox</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.SwipeToDismissBoxValue</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.Text</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.rememberSwipeToDismissBoxState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.Composable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Alignment</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Modifier</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.graphics.Color</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.res.painterResource</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.tooling.preview.Preview</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.dp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.sp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.R</span>

<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">CityCard</span><span class="p">(</span>
<span class="w">    </span><span class="n">city</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">onCityClick</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">,</span>
<span class="w">    </span><span class="n">onDelete</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">dismissState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rememberSwipeToDismissBoxState</span><span class="p">(</span><span class="n">confirmValueChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">it</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">SwipeToDismissBoxValue</span><span class="p">.</span><span class="na">EndToStart</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">onDelete</span><span class="p">(</span><span class="n">city</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="nd">@rememberSwipeToDismissBoxState</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">        </span><span class="c1">// positional threshold of 25%</span>
<span class="w">        </span><span class="n">positionalThreshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">.</span><span class="m">25f</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="n">OutlinedCard</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">        </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">SwipeToDismissBox</span><span class="p">(</span>
<span class="w">            </span><span class="n">enableDismissFromStartToEnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">            </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dismissState</span><span class="p">,</span>
<span class="w">            </span><span class="n">backgroundContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                        </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">                        </span><span class="p">.</span><span class="na">background</span><span class="p">(</span>
<span class="w">                            </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">dismissState</span><span class="p">.</span><span class="na">dismissDirection</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">SwipeToDismissBoxValue</span><span class="p">.</span><span class="na">EndToStart</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Red</span>
<span class="w">                                </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">background</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                        </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">12.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                    </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span><span class="p">,</span>
<span class="w">                    </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">End</span>
<span class="w">                </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                        </span><span class="n">imageVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Delete</span><span class="p">,</span>
<span class="w">                        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Delete&quot;</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">ListItem</span><span class="p">(</span>
<span class="w">                </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ListItemDefaults</span><span class="p">.</span><span class="na">colors</span><span class="p">(</span><span class="n">containerColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primaryContainer</span><span class="p">),</span>
<span class="w">                </span><span class="n">headlineContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">city</span><span class="p">,</span>
<span class="w">                        </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">24.</span><span class="n">sp</span>
<span class="w">                    </span><span class="p">)</span>

<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="n">leadingContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                            </span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">64.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                        </span><span class="n">painter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">painterResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">drawable</span><span class="p">.</span><span class="na">ic_placeholder</span><span class="p">),</span>
<span class="w">                        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">clickable</span><span class="p">(</span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">onCityClick</span><span class="p">(</span>
<span class="w">                        </span><span class="n">city</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="nd">@Preview</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">CityCardPreview</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">CityCard</span><span class="p">(</span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Budapest&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">onCityClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="n">onDelete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{})</span>
<span class="p">}</span>
</code></pre></div>
<p>We didn't create our own complex layout for the display, but rather used the built-in <code>ListItem</code> <em>composable</em>. The functionality we need, such as displaying text and inserting an image, can be easily done with the <em>headlineContent</em> and <em>leadingContent</em> *properties.</p>
<p>Notice how we disable the swipe to the left in <code>SwipeToDismissBox</code> and how we set its state!</p>
<p>After displaying the city list, all we have to do is enable the addition of a new city. We will do this with a simple general dialog where the user can enter text.</p>
<p><code>StringInputDialog.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.citylist.components</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.background</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.Arrangement</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.Column</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.Row</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.Spacer</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.fillMaxWidth</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.height</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.padding</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.shape.RoundedCornerShape</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.text.KeyboardOptions</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.Button</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.Card</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.MaterialTheme</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.OutlinedButton</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.OutlinedTextField</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.Text</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.Composable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.getValue</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.mutableStateOf</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.remember</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.setValue</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Alignment</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Modifier</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.res.stringResource</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.font.FontWeight</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.text.input.ImeAction</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.tooling.preview.Preview</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.dp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.sp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.window.Dialog</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.R</span>

<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">StringInputDialog</span><span class="p">(</span>
<span class="w">    </span><span class="n">modifier</span><span class="p">:</span><span class="w"> </span><span class="n">Modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">,</span>
<span class="w">    </span><span class="n">title</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">label</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">onDismiss</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">,</span>
<span class="w">    </span><span class="n">onConfirm</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Dialog</span><span class="p">(</span><span class="n">onDismissRequest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onDismiss</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Card</span><span class="p">(</span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Column</span><span class="p">(</span>
<span class="w">                </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modifier</span>
<span class="w">                    </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">background</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">                </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                    </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">title</span><span class="p">,</span>
<span class="w">                    </span><span class="n">fontWeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontWeight</span><span class="p">.</span><span class="na">Bold</span><span class="p">,</span>
<span class="w">                    </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">24.</span><span class="n">sp</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">                </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                </span><span class="kd">var</span><span class="w"> </span><span class="nv">input</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">                </span><span class="kd">var</span><span class="w"> </span><span class="nv">isInputError</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">}</span>
<span class="w">                </span><span class="n">OutlinedTextField</span><span class="p">(</span>
<span class="w">                    </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                    </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="p">,</span>
<span class="w">                    </span><span class="n">onValueChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span>
<span class="w">                        </span><span class="n">isInputError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">()</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="n">maxLines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">                    </span><span class="n">isError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isInputError</span><span class="p">,</span>
<span class="w">                    </span><span class="n">keyboardOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyboardOptions</span><span class="p">(</span><span class="n">imeAction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImeAction</span><span class="p">.</span><span class="na">Done</span><span class="p">),</span>
<span class="w">                    </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">                </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                </span><span class="n">Row</span><span class="p">(</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">                    </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">SpaceEvenly</span>
<span class="w">                </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">OutlinedButton</span><span class="p">(</span>
<span class="w">                        </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onDismiss</span><span class="p">,</span>
<span class="w">                        </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modifier</span>
<span class="w">                            </span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">)</span>
<span class="w">                            </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Text</span><span class="p">(</span><span class="n">stringResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">string</span><span class="p">.</span><span class="na">cancel</span><span class="p">))</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                    </span><span class="n">Button</span><span class="p">(</span>
<span class="w">                        </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isInputError</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">onConfirm</span><span class="p">(</span><span class="n">input</span><span class="p">)</span>
<span class="w">                                </span><span class="n">onDismiss</span><span class="p">()</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">},</span>
<span class="w">                        </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RoundedCornerShape</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modifier</span>
<span class="w">                            </span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">)</span>
<span class="w">                            </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Text</span><span class="p">(</span><span class="n">stringResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">string</span><span class="p">.</span><span class="na">ok</span><span class="p">))</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="nd">@Preview</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">StringInputDialogPreview</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">StringInputDialog</span><span class="p">(</span>
<span class="w">        </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;New City&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;City name&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">onDismiss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{},</span>
<span class="w">        </span><span class="n">onConfirm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>This function will have two lambda parameters, <code>onDismiss</code> which will be responsible for dismissing our dialog window, and <code>onConfirm</code> which will allow us to add the new city. We will pass these lambda parameters as parameters to the other functions as follows.</p>
<ul>
<li>
<p><code>onDismiss</code> - This parameter must be received by both buttons, because if we add a new city we want the window to disappear, and if we change our mind and do not want to add a new city, the window must still be deleted.</p>
</li>
<li>
<p><code>onConfirm</code> - We will only put this on the positive button, with a <em>string</em> parameter, which will be changeable according to the input field.</p>
</li>
</ul>
<h4 id="building-the-citylistscreen">Building the CityListScreen<a class="headerlink" href="#building-the-citylistscreen" title="Permanent link">&para;</a></h4>
<p>Once we have the <em>viewmodel</em> and the components, all that's left to do is put together the <code>CityListScreen</code> in the <code>hu.bme.aut.android.weatherinfo.feature.citylist</code> <em>package</em>.</p>
<p><code>CityListScreen.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.citylist</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.Spacer</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.height</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.padding</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.lazy.LazyColumn</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.lazy.items</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.Icons</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.filled.Add</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.CircularProgressIndicator</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.ExperimentalMaterial3Api</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.Icon</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.LargeFloatingActionButton</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.MaterialTheme</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.Scaffold</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.Text</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.TopAppBar</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.TopAppBarDefaults</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.Composable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.getValue</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.mutableStateOf</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.remember</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.setValue</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Modifier</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.res.stringResource</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.tooling.preview.Preview</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.dp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.compose.collectAsStateWithLifecycle</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.viewmodel.compose.viewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.R</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.citylist.components.CityCard</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.citylist.components.StringInputDialog</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.citylist.state.CityListState</span>

<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">CityListScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">onCityClick</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">,</span>
<span class="w">    </span><span class="n">viewModel</span><span class="p">:</span><span class="w"> </span><span class="n">CityListViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewModel</span><span class="p">(</span><span class="n">factory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CityListViewModel</span><span class="p">.</span><span class="na">Factory</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewModel</span><span class="p">.</span><span class="na">state</span><span class="p">.</span><span class="na">collectAsStateWithLifecycle</span><span class="p">().</span><span class="na">value</span>

<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">isNewCityDialogOpen</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">        </span><span class="n">topBar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">TopAppBar</span><span class="p">(</span>
<span class="w">                </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">string</span><span class="p">.</span><span class="na">app_name</span><span class="p">))</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TopAppBarDefaults</span><span class="p">.</span><span class="na">topAppBarColors</span><span class="p">(</span>
<span class="w">                    </span><span class="n">containerColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span><span class="p">,</span>
<span class="w">                    </span><span class="n">titleContentColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onPrimary</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">floatingActionButton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">LargeFloatingActionButton</span><span class="p">(</span>
<span class="w">                </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">isNewCityDialogOpen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="n">containerColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span>
<span class="w">            </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                    </span><span class="n">imageVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Add</span><span class="p">,</span>
<span class="w">                    </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">innerPadding</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">CityListState</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">CircularProgressIndicator</span><span class="p">()</span>
<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">CityListState</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">error</span><span class="p">.</span><span class="na">toString</span><span class="p">())</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="k">is</span><span class="w"> </span><span class="n">CityListState</span><span class="p">.</span><span class="na">Result</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">LazyColumn</span><span class="p">(</span>
<span class="w">                    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                        </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">innerPadding</span><span class="p">)</span>
<span class="w">                        </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">items</span><span class="p">(</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">cityList</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">item</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">city</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                        </span><span class="n">CityCard</span><span class="p">(</span>
<span class="w">                            </span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">city</span><span class="p">.</span><span class="na">name</span><span class="p">,</span>
<span class="w">                            </span><span class="n">onCityClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onCityClick</span><span class="p">,</span>
<span class="w">                            </span><span class="n">onDelete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/*TODO remove city*/</span><span class="w"> </span><span class="p">}</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">cityList</span><span class="p">.</span><span class="na">size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">cityList</span><span class="p">.</span><span class="na">indexOf</span><span class="p">(</span><span class="n">city</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">))</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>


<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isNewCityDialogOpen</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="n">StringInputDialog</span><span class="p">(</span>
<span class="w">                </span><span class="n">onDismiss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">isNewCityDialogOpen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="n">onConfirm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cityList</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                    </span><span class="n">viewModel</span><span class="p">.</span><span class="na">addCity</span><span class="p">(</span><span class="n">cityList</span><span class="p">)</span>
<span class="w">                    </span><span class="n">isNewCityDialogOpen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">string</span><span class="p">.</span><span class="na">new_city</span><span class="p">),</span>
<span class="w">                </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">string</span><span class="p">.</span><span class="na">new_city_hint</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="nd">@Preview</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">CityListScreenPreview</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">CityListScreen</span><span class="p">(</span><span class="n">onCityClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{})</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="creating-the-navigation">Creating the navigation<a class="headerlink" href="#creating-the-navigation" title="Permanent link">&para;</a></h3>
<p>As usual, we will use <code>NavGraph</code> for navigation. So let's create the necessary classes in the <code>hu.bme.aut.android.weatherinfo.navigation</code> <em>package</em>.</p>
<p><code>Screen.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.navigation</span>

<span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Screen</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">route</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">object</span><span class="w"> </span><span class="nc">CityListScreen</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span><span class="p">(</span><span class="n">route</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;city_list&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p><code>NavGraph.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.navigation</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.Composable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Modifier</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.NavHostController</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.NavType</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.compose.NavHost</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.compose.composable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.compose.rememberNavController</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.citylist.CityListScreen</span>

<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">NavGraph</span><span class="p">(</span>
<span class="w">    </span><span class="n">modifier</span><span class="p">:</span><span class="w"> </span><span class="n">Modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">,</span>
<span class="w">    </span><span class="n">navController</span><span class="p">:</span><span class="w"> </span><span class="n">NavHostController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rememberNavController</span><span class="p">(),</span>
<span class="w">    </span><span class="n">startDestination</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Screen</span><span class="p">.</span><span class="na">CityListScreen</span><span class="p">.</span><span class="na">route</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">NavHost</span><span class="p">(</span>
<span class="w">        </span><span class="n">navController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navController</span><span class="p">,</span>
<span class="w">        </span><span class="n">startDestination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">startDestination</span><span class="p">,</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modifier</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">composable</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">CityListScreen</span><span class="p">.</span><span class="na">route</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">CityListScreen</span><span class="p">(</span>
<span class="w">                </span><span class="n">onCityClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/*TODO navigation*/</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Finally, let's add our <code>NavGraph</code> to <code>MainActivity</code>.</p>
<p><code>MainActivity.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo</span>

<span class="k">import</span><span class="w"> </span><span class="nn">android.os.Bundle</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.activity.ComponentActivity</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.activity.compose.setContent</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.activity.enableEdgeToEdge</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.navigation.NavGraph</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.ui.theme.WeatherInfoTheme</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">MainActivity</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ComponentActivity</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">:</span><span class="w"> </span><span class="n">Bundle?)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">)</span>
<span class="w">        </span><span class="n">enableEdgeToEdge</span><span class="p">()</span>
<span class="w">        </span><span class="n">setContent</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">WeatherInfoTheme</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">NavGraph</span><span class="p">()</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>At this point, the city list will appear, and we can add a new item to it.</p>
<p>Let's try the application!</p>
<div class="admonition example">
<p class="admonition-title">TO BE SUBMITTED (1 point)</p>
<p>Create a <strong>screenshot</strong> showing the <strong>list of city names with a newly added city named your NEPTUN code</strong> (on emulator, mirroring device or by screenshot), the <strong>NewCityDialog</strong> code, and your <strong>neptun code somewhere in the code as a comment</strong>! Upload the image to the repository in the solution as f1.png!</p>
</div>
<p>The screenshot is a necessary condition for getting a score.</p>
<h2 id="creating-the-weather-view-and-connecting-it-to-the-navigation-2-points">Creating the weather view and connecting it to the navigation (2 points)<a class="headerlink" href="#creating-the-weather-view-and-connecting-it-to-the-navigation-2-points" title="Permanent link">&para;</a></h2>
<h3 id="designing-the-architecture">Designing the architecture<a class="headerlink" href="#designing-the-architecture" title="Permanent link">&para;</a></h3>
<p>Our data flow will be similar to the ones we saw earlier, (<em>repository</em> -&gt; <em>viewmodel</em> -&gt; <em>screen</em>), so let's create these.</p>
<h4 id="model-classes">Model Classes<a class="headerlink" href="#model-classes" title="Permanent link">&para;</a></h4>
<p>The <a href="https://openweathermap.org/current">OpenWeatherMap API</a> will return the current weather in a JSON object in response to our requests.</p>
<div class="admonition info">
<p class="admonition-title">API call (replace {appID} with your own)</p>
<p><a href="https://api.openweathermap.org/data/2.5/weather?q=Budapest&amp;units=metric&amp;appid={appId">https://api.openweathermap.org/data/2.5/weather?q=Budapest&amp;units=metric&amp;appid={appId</a>}</p>
</div>
<details class="info">
<summary>Api response</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;coord&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;lon&quot;</span><span class="p">:</span><span class="mf">19.0399</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;lat&quot;</span><span class="p">:</span><span class="mf">47.498</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;weather&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="mi">741</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;main&quot;</span><span class="p">:</span><span class="s2">&quot;Fog&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;fog&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;icon&quot;</span><span class="p">:</span><span class="s2">&quot;50n&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;base&quot;</span><span class="p">:</span><span class="s2">&quot;stations&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;main&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;temp&quot;</span><span class="p">:</span><span class="mf">9.98</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;feels_like&quot;</span><span class="p">:</span><span class="mf">9.98</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;temp_min&quot;</span><span class="p">:</span><span class="mf">8.93</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;temp_max&quot;</span><span class="p">:</span><span class="mf">10.71</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;pressure&quot;</span><span class="p">:</span><span class="mi">1013</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;humidity&quot;</span><span class="p">:</span><span class="mi">96</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;sea_level&quot;</span><span class="p">:</span><span class="mi">1013</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;grnd_level&quot;</span><span class="p">:</span><span class="mi">991</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;visibility&quot;</span><span class="p">:</span><span class="mi">8000</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;wind&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;speed&quot;</span><span class="p">:</span><span class="mf">1.03</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;deg&quot;</span><span class="p">:</span><span class="mi">0</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;clouds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;all&quot;</span><span class="p">:</span><span class="mi">43</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;dt&quot;</span><span class="p">:</span><span class="mi">1728250809</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;sys&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="mi">2009313</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;country&quot;</span><span class="p">:</span><span class="s2">&quot;HU&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sunrise&quot;</span><span class="p">:</span><span class="mi">1728190192</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;sunset&quot;</span><span class="p">:</span><span class="mi">1728231218</span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;timezone&quot;</span><span class="p">:</span><span class="mi">7200</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="mi">3054643</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Budapest&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;cod&quot;</span><span class="p">:</span><span class="mi">200</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>In order to make objects that we can use from this, we will need the model class(es) and the <code>Moshi</code> library, which performs the conversion. In this phase, we first create the model classes. As you can see, the resulting <em>JSON</em> is quite complicated and contains many subnodes. Fortunately, we don't have to manually parse our classes from <em>JSON</em>. On the one hand, most <em>APIs</em> provide an extensive description of the model, and on the other hand, there are many converters for the <em>JSON</em> -&gt; <em>Kotlin class</em> conversion. We will now ask for the help of an Android Studio Plugin.</p>
<p>Find <em>Plugins</em> in the Android Studio settings, and there, in the <em>Marketplace</em> search box, enter <em>JSON To Kotlin Class</em>, and install the <em>plugin</em> found.</p>
<p align="center">
<img src="./assets/plugin.png" width="720">
</p>

<p>Once you have this, create the <em>package</em> of the model classes at <code>hu.bme.aut.android.weatherinfo.data.network.model</code>. After that, right-click on the <em>package</em>, then <em>New</em>-&gt; <em>Kotlin data class File from JSON</em>.</p>
<p align="center">
<img src="./assets/jsontokotlin.png" width="720">
</p>

<p>In the window that appears, replace <em>JSON Text</em> with the <em>JSON</em> we received as the response, and give the name <code>WeatherData</code>.</p>
<p>The plugin also created all the necessary Kotlin classes for the conversion.</p>
<details class="info">
<summary>Model classes</summary>
<p><code>Cloud.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Clouds</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">all</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span>
<span class="p">)</span>
</code></pre></div>
<p><code>Coord.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Coord</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">lon</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">lat</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span>
<span class="p">)</span>
</code></pre></div>
<p><code>Main.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Main</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">temp</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="p">,</span>

<span class="w">    </span><span class="nd">@SerialName</span><span class="p">(</span><span class="s">&quot;feels_like&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">feels_like</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="p">,</span>

<span class="w">    </span><span class="nd">@SerialName</span><span class="p">(</span><span class="s">&quot;temp_min&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">temp_min</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="p">,</span>

<span class="w">    </span><span class="nd">@SerialName</span><span class="p">(</span><span class="s">&quot;temp_max&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">temp_max</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="p">,</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">pressure</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">humidity</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">sea_level</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">grnd_level</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span>
<span class="p">)</span>
</code></pre></div>
<p><code>Sys.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Sys</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">type</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">id</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">country</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">sunrise</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">sunset</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span>
<span class="p">)</span>
</code></pre></div>
<p><code>Weather.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Weather</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">id</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">main</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">description</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">icon</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="p">)</span>
</code></pre></div>
<p><code>WeatherResult.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">WeatherResult</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">coord</span><span class="p">:</span><span class="w"> </span><span class="n">Coord</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">weather</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Weather</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">base</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">main</span><span class="p">:</span><span class="w"> </span><span class="n">Main</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">visibility</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">wind</span><span class="p">:</span><span class="w"> </span><span class="n">Wind</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">clouds</span><span class="p">:</span><span class="w"> </span><span class="n">Clouds</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">dt</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">sys</span><span class="p">:</span><span class="w"> </span><span class="n">Sys</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">timezone</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">id</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">name</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">cod</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span>
<span class="p">)</span>
</code></pre></div>
<p><code>Wind.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Serializable</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Wind</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">speed</span><span class="p">:</span><span class="w"> </span><span class="kt">Double</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">deg</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span>
<span class="p">)</span>
</code></pre></div>
</details>
<h4 id="repository">Repository<a class="headerlink" href="#repository" title="Permanent link">&para;</a></h4>
<p>Once we have our model classes, we can create the <em>repository</em>. We will create a <code>repository</code> <em>package</em> in the <code>hu.bme.aut.android.weatherinfo.data.network</code> package, and then an <code>IWeatherRepository</code> <em>interface</em> in it, which will have a single <em>getWeather()</em> function.</p>
<p><code>IWeatherRepository.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.network.repository</span>

<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.network.model.WeatherData</span>
<span class="k">import</span><span class="w"> </span><span class="nn">retrofit2.Call</span>

<span class="kd">interface</span><span class="w"> </span><span class="nc">IWeatherRepository</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getWeather</span><span class="p">(</span><span class="n">city</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="p">):</span><span class="w"> </span><span class="n">Call</span><span class="o">&lt;</span><span class="n">WeatherData?&gt;</span><span class="o">?</span>
<span class="p">}</span>
</code></pre></div>
<p>Based on this, <code>RetrofitWeatherRepository</code> (which we will later supplement with the network call):</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.network.repository</span>

<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.network.model.WeatherData</span>
<span class="k">import</span><span class="w"> </span><span class="nn">retrofit2.Call</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">RetrofitWeatherRepository</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IWeatherRepository</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getWeather</span><span class="p">(</span><span class="n">city</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="p">):</span><span class="w"> </span><span class="n">Call</span><span class="o">&lt;</span><span class="n">WeatherData?&gt;</span><span class="o">?</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The return value of the <em>getWeather()</em> function will be an object of type <code>Call&lt;WeatherData&gt;</code>. (We import the retrofitted <em>Call</em> from the options that appear.) This describes a network call whose response can be converted into an object of type <em>WeatherData</em>.</p>
<p>Let's instantiate <em>repository</em> again in our *application class.</p>
<p><code>WeatherInfoApplication.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo</span>

<span class="k">import</span><span class="w"> </span><span class="nn">android.app.Application</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.local.repository.ICityRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.local.repository.MemoryCityRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.network.repository.IWeatherRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.network.repository.RetrofitWeatherRepository</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">WeatherInfoApplication</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Application</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">companion</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="err">{</span>

<span class="w">        </span><span class="kd">lateinit</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">weatherRepository</span><span class="p">:</span><span class="w"> </span><span class="n">IWeatherRepository</span>
<span class="w">        </span><span class="kd">lateinit</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">cityRepository</span><span class="p">:</span><span class="w"> </span><span class="n">ICityRepository</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">()</span>

<span class="w">        </span><span class="n">weatherRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RetrofitWeatherRepository</span><span class="p">()</span>
<span class="w">        </span><span class="n">cityRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MemoryCityRepository</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="the-viewmodel_1">The ViewModel<a class="headerlink" href="#the-viewmodel_1" title="Permanent link">&para;</a></h4>
<p>Our <em>viewmodel</em> will also store a state in which the weather data is in observable form. So let's first create this state in the <code>hu.bme.aut.android.weatherinfo.feature.weather.state</code> <em>package</em>.</p>
<p><code>WeatherState.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.weather.state</span>

<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.network.model.WeatherData</span>

<span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">WeatherState</span><span class="p">{</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">Loading</span><span class="p">:</span><span class="w"> </span><span class="n">WeatherState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Error</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">error</span><span class="p">:</span><span class="w"> </span><span class="n">Throwable</span><span class="p">):</span><span class="w"> </span><span class="n">WeatherState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Success</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">weatherData</span><span class="p">:</span><span class="w"> </span><span class="n">WeatherData?)</span><span class="p">:</span><span class="w"> </span><span class="n">WeatherState</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>
<p>Now the <em>viewmodel</em> can be added to the <code>hu.bme.aut.android.weatherinfo.feature.weather</code> package.</p>
<p><code>WeatherViewModel.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.weather</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.SavedStateHandle</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.ViewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.ViewModelProvider</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.createSavedStateHandle</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.viewModelScope</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.viewmodel.initializer</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.viewmodel.viewModelFactory</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.WeatherInfoApplication</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.network.model.WeatherData</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.network.repository.IWeatherRepository</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.weather.state.WeatherState</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.MutableStateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.flow.asStateFlow</span>
<span class="k">import</span><span class="w"> </span><span class="nn">kotlinx.coroutines.launch</span>
<span class="k">import</span><span class="w"> </span><span class="nn">retrofit2.Call</span>
<span class="k">import</span><span class="w"> </span><span class="nn">retrofit2.Callback</span>
<span class="k">import</span><span class="w"> </span><span class="nn">retrofit2.Response</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">WeatherViewModel</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">savedStateHandle</span><span class="p">:</span><span class="w"> </span><span class="n">SavedStateHandle</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">weatherRepository</span><span class="p">:</span><span class="w"> </span><span class="n">IWeatherRepository</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ViewModel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="o">&lt;</span><span class="n">WeatherState</span><span class="o">&gt;</span><span class="p">(</span><span class="n">WeatherState</span><span class="p">.</span><span class="na">Loading</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">_cityName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="p">(</span><span class="n">checkNotNull</span><span class="p">(</span><span class="n">savedStateHandle</span><span class="o">[</span><span class="s">&quot;cityName&quot;</span><span class="o">]</span><span class="p">))</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">cityName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_cityName</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="k">init</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">getWeather</span><span class="p">(</span><span class="n">checkNotNull</span><span class="p">(</span><span class="n">savedStateHandle</span><span class="o">[</span><span class="s">&quot;cityName&quot;</span><span class="o">]</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getWeather</span><span class="p">(</span><span class="n">cityName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WeatherState</span><span class="p">.</span><span class="na">Loading</span>
<span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">weatherRepository</span><span class="p">.</span><span class="na">getWeather</span><span class="p">(</span><span class="n">cityName</span><span class="p">)</span>
<span class="w">                    </span><span class="o">?.</span><span class="na">enqueue</span><span class="p">(</span><span class="k">object</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nc">Callback</span><span class="o">&lt;</span><span class="n">WeatherData?&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">onResponse</span><span class="p">(</span>
<span class="w">                            </span><span class="n">call</span><span class="p">:</span><span class="w"> </span><span class="n">Call</span><span class="o">&lt;</span><span class="n">WeatherData?&gt;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">response</span><span class="p">:</span><span class="w"> </span><span class="n">Response</span><span class="o">&lt;</span><span class="n">WeatherData?&gt;</span>
<span class="w">                        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">isSuccessful</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">_state</span><span class="p">.</span><span class="na">tryEmit</span><span class="p">(</span><span class="n">WeatherState</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">body</span><span class="p">()))</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">}</span>

<span class="w">                        </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">onFailure</span><span class="p">(</span>
<span class="w">                            </span><span class="n">call</span><span class="p">:</span><span class="w"> </span><span class="n">Call</span><span class="o">&lt;</span><span class="n">WeatherData?&gt;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">t</span><span class="p">:</span><span class="w"> </span><span class="n">Throwable</span>
<span class="w">                        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="n">t</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">()</span>
<span class="w">                            </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WeatherState</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">})</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="p">:</span><span class="w"> </span><span class="n">Exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WeatherState</span><span class="p">.</span><span class="na">Error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">companion</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">Factory</span><span class="p">:</span><span class="w"> </span><span class="n">ViewModelProvider</span><span class="p">.</span><span class="na">Factory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewModelFactory</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">initializer</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">val</span><span class="w"> </span><span class="nv">savedStateHandle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createSavedStateHandle</span><span class="p">()</span>
<span class="w">                </span><span class="kd">val</span><span class="w"> </span><span class="nv">weatherRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WeatherInfoApplication</span><span class="p">.</span><span class="na">weatherRepository</span>
<span class="w">                </span><span class="n">WeatherViewModel</span><span class="p">(</span>
<span class="w">                    </span><span class="n">savedStateHandle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">savedStateHandle</span><span class="p">,</span>
<span class="w">                    </span><span class="n">weatherRepository</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weatherRepository</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The <code>WeatherViewModel</code> receives an instance of <code>IWeatherRepository</code> as a parameter, as well as a <code>SavedStateHandle</code> to read the city name parameter. It also stores the state and the city name (read from the <code>SavedStateHandle</code>). Its only function is <em>getWeather()</em>, which makes a network call with a coroutine. It also contains the <em>Factory method</em> needed to instantiate itself.</p>
<p>You can see that in the <em>getWeather</em> function, we have placed a <em>callback</em> for the response of the <em>getWeather</em> function of the <code>weatherRepository</code> (which is a <em>Call<WeatherData></em> object). This allows us to handle the different states of our network call.</p>
<h3 id="the-weather-interface">The weather interface<a class="headerlink" href="#the-weather-interface" title="Permanent link">&para;</a></h3>
<h4 id="components">Components<a class="headerlink" href="#components" title="Permanent link">&para;</a></h4>
<p>On the weather screen, in addition to the name of the city, the description of its current weather and an icon, we also want to display specific numerical values. To achieve this, let's create a helper <em>composable</em> in the <code>hu.bme.aut.android.weatherinfo.feature.weather.components</code> <em>package</em>, which will help write texts and values ​​next to each other.</p>
<p><code>WeatherDataText.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.weather.components</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.Arrangement</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.Row</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.fillMaxWidth</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.Text</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.Composable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Modifier</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.tooling.preview.Preview</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.TextUnit</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.sp</span>

<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">WeatherDataText</span><span class="p">(</span>
<span class="w">    </span><span class="n">modifier</span><span class="p">:</span><span class="w"> </span><span class="n">Modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">,</span>
<span class="w">    </span><span class="n">label</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="p">,</span>
<span class="w">    </span><span class="n">textSize</span><span class="p">:</span><span class="w"> </span><span class="n">TextUnit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextUnit</span><span class="p">.</span><span class="na">Unspecified</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Row</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">        </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">SpaceBetween</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label</span><span class="p">,</span>
<span class="w">            </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">textSize</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">textSize</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="nd">@Preview</span><span class="p">(</span><span class="n">showBackground</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">WeatherDataTextPreview</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">WeatherDataText</span><span class="p">(</span>
<span class="w">        </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;20&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">textSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16.</span><span class="n">sp</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="creating-the-weatherscreen">Creating the WeatherScreen<a class="headerlink" href="#creating-the-weatherscreen" title="Permanent link">&para;</a></h3>
<p>Now we are ready to create our weather screen in the <code>hu.bme.aut.android.weatherinfo.feature.weather</code> <em>package</em>.</p>
<p><code>WeatherScreen.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.weather</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.Box</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.Column</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.Spacer</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.fillMaxSize</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.padding</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.foundation.layout.size</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.Icons</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material.icons.automirrored.filled.ArrowBack</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.CircularProgressIndicator</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.ExperimentalMaterial3Api</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.Icon</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.IconButton</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.MaterialTheme</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.Scaffold</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.Text</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.TopAppBar</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.material3.TopAppBarDefaults</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.Composable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Alignment</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Modifier</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.layout.ContentScale</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.platform.LocalContext</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.res.painterResource</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.res.stringResource</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.tooling.preview.Preview</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.dp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.unit.sp</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.compose.collectAsStateWithLifecycle</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.lifecycle.viewmodel.compose.viewModel</span>
<span class="k">import</span><span class="w"> </span><span class="nn">coil.compose.AsyncImage</span>
<span class="k">import</span><span class="w"> </span><span class="nn">coil.request.ImageRequest</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.R</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.weather.components.WeatherDataText</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.weather.state.WeatherState</span>

<span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">WeatherScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">weatherViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">WeatherViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewModel</span><span class="p">(</span><span class="n">factory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WeatherViewModel</span><span class="p">.</span><span class="na">Factory</span><span class="p">),</span>
<span class="w">    </span><span class="n">onNavigateBack</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weatherViewModel</span><span class="p">.</span><span class="na">state</span><span class="p">.</span><span class="na">collectAsStateWithLifecycle</span><span class="p">().</span><span class="na">value</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">cityName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weatherViewModel</span><span class="p">.</span><span class="na">cityName</span><span class="p">.</span><span class="na">collectAsStateWithLifecycle</span><span class="p">().</span><span class="na">value</span>

<span class="w">    </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">(),</span>
<span class="w">        </span><span class="n">topBar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">TopAppBar</span><span class="p">(</span>
<span class="w">                </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringResource</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">string</span><span class="p">.</span><span class="na">weather_in</span><span class="p">,</span><span class="w"> </span><span class="n">cityName</span><span class="p">))</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="n">navigationIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">IconButton</span><span class="p">(</span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">onNavigateBack</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">                            </span><span class="n">imageVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">AutoMirrored</span><span class="p">.</span><span class="na">Filled</span><span class="p">.</span><span class="na">ArrowBack</span><span class="p">,</span>
<span class="w">                            </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TopAppBarDefaults</span><span class="p">.</span><span class="na">topAppBarColors</span><span class="p">(</span>
<span class="w">                    </span><span class="n">containerColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">primary</span><span class="p">,</span>
<span class="w">                    </span><span class="n">titleContentColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onPrimary</span><span class="p">,</span>
<span class="w">                    </span><span class="n">navigationIconContentColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">onPrimary</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">})</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="n">innerPadding</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="n">Box</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">innerPadding</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">WeatherState</span><span class="p">.</span><span class="na">Loading</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">CircularProgressIndicator</span><span class="p">(</span>
<span class="w">                        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MaterialTheme</span><span class="p">.</span><span class="na">colorScheme</span><span class="p">.</span><span class="na">secondaryContainer</span><span class="p">,</span>
<span class="w">                        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">align</span><span class="p">(</span><span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span><span class="p">)</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>

<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">WeatherState</span><span class="p">.</span><span class="na">Error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">error</span><span class="p">.</span><span class="na">message</span><span class="p">.</span><span class="na">toString</span><span class="p">()</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>

<span class="w">                </span><span class="k">is</span><span class="w"> </span><span class="n">WeatherState</span><span class="p">.</span><span class="na">Success</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">Column</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">weatherData</span><span class="o">?.</span><span class="na">weather</span><span class="o">?.</span><span class="na">get</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="o">?.</span><span class="na">description</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">24.</span><span class="n">sp</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                        </span><span class="n">AsyncImage</span><span class="p">(</span>
<span class="w">                            </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImageRequest</span><span class="p">.</span><span class="na">Builder</span><span class="p">(</span><span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalContext</span><span class="p">.</span><span class="na">current</span><span class="p">)</span>
<span class="w">                                </span><span class="p">.</span><span class="na">data</span><span class="p">(</span><span class="s">&quot;https://openweathermap.org/img/w/</span><span class="si">${</span><span class="n">state</span><span class="p">.</span><span class="na">weatherData</span><span class="o">?.</span><span class="na">weather</span><span class="o">?.</span><span class="na">first</span><span class="p">()</span><span class="o">?.</span><span class="na">icon</span><span class="si">}</span><span class="s">.png&quot;</span><span class="p">)</span>
<span class="w">                                </span><span class="p">.</span><span class="na">crossfade</span><span class="p">(</span><span class="n">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="w">                                </span><span class="p">.</span><span class="na">build</span><span class="p">(),</span>
<span class="w">                            </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">                            </span><span class="n">contentScale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ContentScale</span><span class="p">.</span><span class="na">Crop</span><span class="p">,</span>
<span class="w">                            </span><span class="n">placeholder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">painterResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">drawable</span><span class="p">.</span><span class="na">ic_placeholder</span><span class="p">),</span>
<span class="w">                            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                                </span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">320.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                                </span><span class="p">.</span><span class="na">align</span><span class="p">(</span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">)</span>
<span class="w">                        </span><span class="p">)</span>

<span class="w">                        </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">24.</span><span class="n">dp</span><span class="p">))</span>

<span class="w">                        </span><span class="n">WeatherDataText</span><span class="p">(</span>
<span class="w">                            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">0.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">0.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                            </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">string</span><span class="p">.</span><span class="na">label_temperature</span><span class="p">),</span>
<span class="w">                            </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="si">${</span><span class="n">state</span><span class="p">.</span><span class="na">weatherData</span><span class="o">?.</span><span class="na">main</span><span class="o">?.</span><span class="na">temp</span><span class="si">}</span><span class="s"> \u2103&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">textSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">24.</span><span class="n">sp</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                        </span><span class="n">WeatherDataText</span><span class="p">(</span>
<span class="w">                            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">0.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">0.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                            </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">string</span><span class="p">.</span><span class="na">label_min_temperature</span><span class="p">),</span>
<span class="w">                            </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="si">${</span><span class="n">state</span><span class="p">.</span><span class="na">weatherData</span><span class="o">?.</span><span class="na">main</span><span class="o">?.</span><span class="na">temp_min</span><span class="si">}</span><span class="s"> \u2103&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">textSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">24.</span><span class="n">sp</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                        </span><span class="n">WeatherDataText</span><span class="p">(</span>
<span class="w">                            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">0.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">0.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                            </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">string</span><span class="p">.</span><span class="na">label_max_temperature</span><span class="p">),</span>
<span class="w">                            </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="si">${</span><span class="n">state</span><span class="p">.</span><span class="na">weatherData</span><span class="o">?.</span><span class="na">main</span><span class="o">?.</span><span class="na">temp_max</span><span class="si">}</span><span class="s"> \u2103&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">textSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">24.</span><span class="n">sp</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                        </span><span class="n">WeatherDataText</span><span class="p">(</span>
<span class="w">                            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">0.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">0.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                            </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">string</span><span class="p">.</span><span class="na">label_pressure</span><span class="p">),</span>
<span class="w">                            </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="si">${</span><span class="n">state</span><span class="p">.</span><span class="na">weatherData</span><span class="o">?.</span><span class="na">main</span><span class="o">?.</span><span class="na">pressure</span><span class="si">}</span><span class="s"> hPa&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">textSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">24.</span><span class="n">sp</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                        </span><span class="n">WeatherDataText</span><span class="p">(</span>
<span class="w">                            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">0.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">0.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">8.</span><span class="n">dp</span><span class="p">),</span>
<span class="w">                            </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">string</span><span class="p">.</span><span class="na">label_humidity</span><span class="p">),</span>
<span class="w">                            </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="si">${</span><span class="n">state</span><span class="p">.</span><span class="na">weatherData</span><span class="o">?.</span><span class="na">main</span><span class="o">?.</span><span class="na">humidity</span><span class="si">}</span><span class="s"> %&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">textSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">24.</span><span class="n">sp</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="nd">@Preview</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">WeatherScreenPreview</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">WeatherScreen</span><span class="p">(</span><span class="n">onNavigateBack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{})</span>
<span class="p">}</span>
</code></pre></div>
<p>The framework of our interface is a <code>Scaffold</code>, in which we display the name of the city on the <em>topBar</em> and add a back navigation icon. Notice how we display a parameterized <em>string</em> from the resources.</p>
<p>Depending on the state, the content of the page is either a <code>CircularProgressIndicator</code>, an error text, or the weather data for the given city.</p>
<p>Notice how we use the <em>AsyncImage</em> function of the <em>Coil</em> library in the code to display the image found on the web!</p>
<h4 id="connection-to-navigation">Connection to navigation<a class="headerlink" href="#connection-to-navigation" title="Permanent link">&para;</a></h4>
<p>Let's supplement our <code>Screen</code> class with the new screen.</p>
<p><code>Screen.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.navigation</span>

<span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Screen</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">route</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">object</span><span class="w"> </span><span class="nc">CityListScreen</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span><span class="p">(</span><span class="n">route</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;city_list&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="kd">object</span><span class="w"> </span><span class="nc">WeatherScreen</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Screen</span><span class="p">(</span><span class="n">route</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;weather/{</span><span class="si">${</span><span class="n">Args</span><span class="p">.</span><span class="na">cityName</span><span class="si">}</span><span class="s">}&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">fun</span><span class="w"> </span><span class="nf">passCityName</span><span class="p">(</span><span class="n">cityName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;weather/</span><span class="si">$</span><span class="n">cityName</span><span class="s">&quot;</span>

<span class="w">        </span><span class="kd">object</span><span class="w"> </span><span class="nc">Args</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">cityName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;cityName&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Let's see how we implement the city name to be passed as a parameter to <code>WeatherScreen</code>.</p>
<p>Here's the updated <code>NavGraph</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.navigation</span>

<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.runtime.Composable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.compose.ui.Modifier</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.NavHostController</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.NavType</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.compose.NavHost</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.compose.composable</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.compose.rememberNavController</span>
<span class="k">import</span><span class="w"> </span><span class="nn">androidx.navigation.navArgument</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.citylist.CityListScreen</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.feature.weather.WeatherScreen</span>

<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">NavGraph</span><span class="p">(</span>
<span class="w">    </span><span class="n">modifier</span><span class="p">:</span><span class="w"> </span><span class="n">Modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">,</span>
<span class="w">    </span><span class="n">navController</span><span class="p">:</span><span class="w"> </span><span class="n">NavHostController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rememberNavController</span><span class="p">(),</span>
<span class="w">    </span><span class="n">startDestination</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Screen</span><span class="p">.</span><span class="na">CityListScreen</span><span class="p">.</span><span class="na">route</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">NavHost</span><span class="p">(</span>
<span class="w">        </span><span class="n">navController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navController</span><span class="p">,</span>
<span class="w">        </span><span class="n">startDestination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">startDestination</span><span class="p">,</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modifier</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">composable</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">CityListScreen</span><span class="p">.</span><span class="na">route</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">CityListScreen</span><span class="p">(</span>
<span class="w">                </span><span class="n">onCityClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">WeatherScreen</span><span class="p">.</span><span class="na">passCityName</span><span class="p">(</span><span class="n">cityName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span><span class="p">))</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">composable</span><span class="p">(</span>
<span class="w">            </span><span class="n">Screen</span><span class="p">.</span><span class="na">WeatherScreen</span><span class="p">.</span><span class="na">route</span><span class="p">,</span>
<span class="w">            </span><span class="n">arguments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listOf</span><span class="p">(</span><span class="n">navArgument</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="na">WeatherScreen</span><span class="p">.</span><span class="na">Args</span><span class="p">.</span><span class="na">cityName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">defaultValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Budapest&quot;</span>
<span class="w">                </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NavType</span><span class="p">.</span><span class="na">StringType</span>
<span class="w">            </span><span class="p">})</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">WeatherScreen</span><span class="p">(</span><span class="n">onNavigateBack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">navController</span><span class="p">.</span><span class="na">popBackStack</span><span class="p">()</span><span class="w"> </span><span class="p">})</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Let's try the application!</p>
<p>Our weather screen appears, there is the caption in the header, but the real data is not visible, since our <em>repository</em> always returns a <em>null</em> data. Therefore, we only see the loading screen.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>If we want to see the <code>WeatherScreen</code> in its entirety, let's change the status at the beginning of the <em>getWeather</em> function from <em>Loading</em> to <em>Success</em>.</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WeatherState</span><span class="p">.</span><span class="na">Success</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="p">...</span>
</code></pre></div>
</div>
<div class="admonition example">
<p class="admonition-title">TO BE SUBMITTED (2 points)</p>
<p>Create a <strong>screenshot</strong> showing the <strong>weather view with the appropriate header</strong> (on emulator, device mirroring or screen capture), the <strong>WeatherScreen</strong> code, and your <strong>neptun code somewhere in the code as a comment</strong>! Upload the image to the repository in the solution as f2.png!</p>
<p>The screenshot is a necessary condition for obtaining a score.</p>
</div>
<h2 id="creating-the-network-communication-1-point">Creating the Network Communication (1 point)<a class="headerlink" href="#creating-the-network-communication-1-point" title="Permanent link">&para;</a></h2>
<h3 id="implementing-the-weatherapi">Implementing the WeatherAPI<a class="headerlink" href="#implementing-the-weatherapi" title="Permanent link">&para;</a></h3>
<p>To execute network requests, we will use the <code>Retrofit</code> external library. We added its dependencies to the appropriate place at the beginning of the lab, now we will only use the library functions.</p>
<p>Let's create a <code>WeatherApi</code> Kotlin file in the <code>hu.bme.aut.android.weatherinfo.data.network</code> package.</p>
<p><code>WeatherApi.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.network</span>

<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.network.model.WeatherData</span>
<span class="k">import</span><span class="w"> </span><span class="nn">retrofit2.Call</span>
<span class="k">import</span><span class="w"> </span><span class="nn">retrofit2.http.GET</span>
<span class="k">import</span><span class="w"> </span><span class="nn">retrofit2.http.Query</span>

<span class="kd">interface</span><span class="w"> </span><span class="nc">WeatherApi</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@GET</span><span class="p">(</span><span class="s">&quot;/data/2.5/weather&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getWeather</span><span class="p">(</span>
<span class="w">        </span><span class="nd">@Query</span><span class="p">(</span><span class="s">&quot;q&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">cityName</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="p">,</span>
<span class="w">        </span><span class="nd">@Query</span><span class="p">(</span><span class="s">&quot;units&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">units</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="p">,</span>
<span class="w">        </span><span class="nd">@Query</span><span class="p">(</span><span class="s">&quot;appid&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">appId</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span>
<span class="w">    </span><span class="p">):</span><span class="w"> </span><span class="n">Call</span><span class="o">&lt;</span><span class="n">WeatherData?&gt;</span><span class="o">?</span>
<span class="p">}</span>
</code></pre></div>
<p>As you can see, in <em>Retrofit</em> we can use annotations to indicate what network call a given function call will correspond to. The <code>@GET</code> annotation represents an <em>HTTP GET</em> request, and the <em>string</em> given as a parameter indicates which endpoint we want to send the request to relative to the server's base <em>URL</em>.</p>
<div class="admonition note">
<p>We can describe other <em>HTTP</em> request types in a similar way: <em>@POST</em>, <em>@UPDATE</em>, <em>@PATCH</em>, <em>@DELETE</em></p>
</div>
<p>The function parameters are annotated with the <em>@Query</em> annotation. This means that Retrofit appends the value of the given parameter to the request as a <em>query</em> parameter, with the key specified in the annotation.</p>
<div class="admonition note">
<p>Other noteworthy annotations, but not exhaustive: @HEAD, @Multipart, @Field</p>
</div>
<h3 id="updating-the-retrofitweatherrepository">Updating the RetrofitWeatherRepository<a class="headerlink" href="#updating-the-retrofitweatherrepository" title="Permanent link">&para;</a></h3>
<p>Now our <em>interface</em> is ready to make network calls through it. So let's replace the <em>null</em> value returned by <code>RetrofitWeatherRepository</code>'s <em>getWeather</em> function with the actual implementation.</p>
<p><code>RetrofitWeatherRepository.kt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">package</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.network.repository</span>

<span class="k">import</span><span class="w"> </span><span class="nn">com.squareup.moshi.Moshi</span>
<span class="k">import</span><span class="w"> </span><span class="nn">com.squareup.moshi.kotlin.reflect.KotlinJsonAdapterFactory</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.network.WeatherApi</span>
<span class="k">import</span><span class="w"> </span><span class="nn">hu.bme.aut.android.weatherinfo.data.network.model.WeatherData</span>
<span class="k">import</span><span class="w"> </span><span class="nn">okhttp3.OkHttpClient</span>
<span class="k">import</span><span class="w"> </span><span class="nn">retrofit2.Call</span>
<span class="k">import</span><span class="w"> </span><span class="nn">retrofit2.Retrofit</span>
<span class="k">import</span><span class="w"> </span><span class="nn">retrofit2.converter.moshi.MoshiConverterFactory</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">RetrofitWeatherRepository</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">IWeatherRepository</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">retrofit</span><span class="p">:</span><span class="w"> </span><span class="n">Retrofit</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">weatherApi</span><span class="p">:</span><span class="w"> </span><span class="n">WeatherApi</span>

<span class="w">    </span><span class="kd">companion</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">SERVICE_URL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;https://api.openweathermap.org&quot;</span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">APP_ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;APP_ID&quot;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">init</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">moshi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Moshi</span><span class="p">.</span><span class="na">Builder</span><span class="p">().</span><span class="na">addLast</span><span class="p">(</span><span class="n">KotlinJsonAdapterFactory</span><span class="p">()).</span><span class="na">build</span><span class="p">()</span>
<span class="w">        </span><span class="n">retrofit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Retrofit</span><span class="p">.</span><span class="na">Builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">baseUrl</span><span class="p">(</span><span class="n">SERVICE_URL</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">client</span><span class="p">(</span><span class="n">OkHttpClient</span><span class="p">.</span><span class="na">Builder</span><span class="p">().</span><span class="na">build</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">addConverterFactory</span><span class="p">(</span><span class="n">MoshiConverterFactory</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="n">moshi</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">()</span>
<span class="w">        </span><span class="n">weatherApi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">retrofit</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="n">WeatherApi</span><span class="o">::</span><span class="n">class</span><span class="p">.</span><span class="na">java</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getWeather</span><span class="p">(</span><span class="n">city</span><span class="p">:</span><span class="w"> </span><span class="kt">String?</span><span class="p">):</span><span class="w"> </span><span class="n">Call</span><span class="o">&lt;</span><span class="n">WeatherData?&gt;</span><span class="o">?</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">weatherApi</span><span class="p">.</span><span class="na">getWeather</span><span class="p">(</span><span class="n">city</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;metric&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">APP_ID</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>This class will be responsible for handling network requests.</p>
<p>We can request a parameterizable <code>Builder</code> instance by calling <code>Retrofit.Builder()</code>. In this, we can specify the properties of our network calls. In this example, we set the address of the service we want to access, the HTTP client implementation (<a href="http://square.github.io/okhttp/">OkHttp</a>), and the converter between JSON and object representations (Moshi).</p>
<p>From the <code>WeatherApi</code> interface, we can request the parameterized implementation generated at compile time using the <code>Retrofit</code> instance created with <code>Builder</code>.</p>
<p>The object obtained as a result of the <code>retrofit.create(WeatherApi.class)</code> call implements the <code>WeatherApi</code> interface. If we call the <code>getWeather(...)</code> function on this object, the network call we defined in the interface will be made.</p>
<p><strong>Replace</strong> the <code>APP_ID</code> ​​value with your own API key obtained from <a href="https://openweathermap.org/">OpenWeatherMap</a>!</p>
<p>Let's try the application!</p>
<div class="admonition example">
<p class="admonition-title">TO BE SUBMITTED (1 point)</p>
<p>Create a <strong>screenshot</strong> showing the <strong>weather of a city</strong> on the emulator (on the emulator, by mirroring the device or by taking a screenshot), the <strong>RetrofitWeatherRepository</strong> code, and your <strong>neptun code somewhere in the code as a comment</strong>! Upload the image to the repository in the solution as f3.png!</p>
<p>The screenshot is a necessary condition for getting points.</p>
</div>
<h2 id="independent-task-implementing-deletion-from-city-list-1-point">Independent task: implementing deletion from city list (1 point)<a class="headerlink" href="#independent-task-implementing-deletion-from-city-list-1-point" title="Permanent link">&para;</a></h2>
<p>Implement deletion of cities by dragging elements to the left.</p>
<details class="success">
<summary>Steps of implementation</summary>
<ul>
<li>delete function in <em>repository interface</em></li>
<li>delete function in <em>repository</em></li>
<li>delete function in <em>viewmodel</em></li>
<li>delete event handler in <em>CityListScreen</em></li>
</ul>
</details>
<div class="admonition example">
<p class="admonition-title">TO BE SUBMITTED (1 point)</p>
<p>Create a <strong>screenshot</strong> showing the <strong>list of cities ONLY with Budapest</strong> on the emulator (on emulator, mirroring the device or with a screenshot), the <strong>relevant</strong> code snippet for the <strong>deletion</strong>, and your <strong>neptun code somewhere in the code as a comment</strong>! Upload the image to the repository in the solution as f4.png!</p>
<p>The screenshot is a necessary condition for obtaining points.</p>
</div>

    <hr>
  <div class="md-source-file">
    <span class="md-source-file__fact"> <span class="md-icon" title="Utolsó frissítés"> <svg
          xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z">
          </path>
        </svg>
      </span>
      <span title="2025. október 23. 19:40:52">
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="2025. október 23. 19:40:52 CEST"><span class="timeago" datetime="2025-10-23T19:40:52+02:00" locale="hu"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="2025. október 23. 19:40:52 CEST">2025-10-23</span>
      </span>
    </span>

    

    <span class="md-source-file__fact">
      <span class="md-icon" title="Szerzők">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z">
          </path>
        </svg>
      </span>
      <span>Szerzők</span>
      <nav></nav>      
    </span>
  </div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; BME VIK AUT
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.instant", "navigation.top", "search.suggest", "content.code.copy"], "search": "../../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "V\u00e1g\u00f3lapra m\u00e1solva", "clipboard.copy": "M\u00e1sol\u00e1s v\u00e1g\u00f3lapra", "search.result.more.one": "1 tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.more.other": "# tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.none": "Nincs tal\u00e1lat", "search.result.one": "1 egyez\u0151 dokumentum", "search.result.other": "# egyez\u0151 dokumentum", "search.result.placeholder": "Keres\u00e9shez \u00edrj ide valamit", "search.result.term.missing": "\u00dcres", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ba449ae6.min.js"></script>
      
        <script src="../../js/timeago.min.js"></script>
      
        <script src="../../js/timeago_mkdocs_material.js"></script>
      
    
  </body>
</html>